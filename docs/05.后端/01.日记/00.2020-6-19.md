---
title: 2020-6-19
date: 2022-04-03 08:58:56
permalink: /pages/477096/
categories:
  - 后端
  - log
tags:
  - 
---
# 2020-6



## 1.git push 服务器部署



```bash
pwd
tomcat设置项目路径<host>
<Context docBase="/usr/local/apache-tomcat-8.5.56/webapps/gd" path="/" reloadable="true"/>

git命令
git add ./*
git commit -m "s"
git push
/usr/local/apache-tomcat-8.5.56/webapps/gd/WEB-INF/classes

git init --bare classes
cd hooks
vi post-receive
# 指定我的代码检出目录
DIR=/usr/local/apache-tomcat-8.5.56/webapps/gd/WEB-INF/classes
git --work-tree=${DIR} clean -fd
# 直接强制检出
git --work-tree=${DIR} checkout --force

chmod -R 777 post-receive


root@192.168.23.7:/usr/local/apache-tomcat-8.5.56/classes

/usr/local/apache-tomcat-8.5.56/classes
```

## Docker

 Idea安装Docker插件

![image-20200706112809004](https://s2.loli.net/2022/03/26/xc1N93IaniVLhWG.png)

1. 

进入到 目录: /lib/systemd/system/docker.service
对于docker.service 文件进行编辑

2.ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock

![image-20200706112931354](https://s2.loli.net/2022/03/26/eUx3FoqcTmiI5uh.png)



3.重新加载配置文件，重启docker

systemctl daemon-reload

 systemctl start docker



4.关闭防火墙或者防火墙开放端口号2375



5.查看自己开放ip,

![image-20200706113233875](https://s2.loli.net/2022/03/26/kabWrd4jFGsR21p.png)

6.写入idea docker插件

![image-20200706113308857](https://s2.loli.net/2022/03/26/LYqHxGi3Cyp2vI1.png)

2.2 docker命令

## 启动docker

systemctl enable docker.service

systemctl start docker 

## 加载docker守护线程

systemctl daemon-reload

## 重启docker

systemctl restart docker 

查看docker镜像  docker images  看所有 -a



docker批量启动 docker start $(docker ps -a -q --filter "status=exited")



搜索镜像  docker search



查看docker运行的容器 docker ps  看所有 -a

## 查看防火墙状态

sudo systemctl status firewalld



### 

scp D:/Git/wisezone/oasis/gd/target/gd.war code@192.168.3.198://home/code/apache-tomcat-9.0.37/webapps/gd.war



scp -r D:/Git/wisezone/oasis/gd/target/classes/mapper/ code@192.168.3.198://home/code/apache-tomcat-9.0.37/webapps/gd/WEB-INF/classes/mapper/

-P 6900



cp /opt/tomcat/www/temp/integral  /opt/tomcat/www/webapps/stall/WEB-INF/classes/com/wisezone/

docker@default:~$ docker run --name mysql -v /home/ljaer/mysql:/var/lib/mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:latest
ae6314a69997ba2d6036aced07506a47c9d730592fc3fd741d125f104bae6c3c



scp D:/项目/stall/target/stall.war code@47.114.105.55:/opt/tomcat/www/webapps/stall.war



```
//        String tenantId = "048129";
//            Long sellerId = 22L;
```

RS5951000120200817001

```
 String tenantId = "048129";
 Integer accountId = 4;
```

/opt/data/resin/webapps/hy/WEB-INF/classes/com/hy/controller/retail



scp -r  code@192.168.3.198://home/code/www/gd_front/dist D://



scp -r  code@192.168.3.198://opt/data/www/imgs D://

## gitlab docker 安装

```shell
docker restart gitlab
#修改gitlab.rb文件
external_url 'http://1.116.187.163:8089'
nginx['listen_port'] = 8089
gitlab_rails['gitlab_shell_ssh_port'] = 2202
#
```

​    

## typora上传自定义图片

### 具体脚本

```shell
#!/bin/bash
 arr=()
 # 各类配置信息
 remote_path="http://101.200.163.226" # 上传默认的路径
 # 上传图片
 j=0
 n=0
 for i in "$@"; do
	res=$(curl -XPOST --form 'file=@'$i $remote_path'/api/upload')
	arr[$j]=$res
	j=$j+1
 echo 'Upload Success:'	
 done
  for i in "$@"; do
	echo $remote_path${arr[$n]}
	n=$n+1
 done
```

### 脚本位置和执行代码

![image-20220403175416189](http://101.200.163.226/img/20220403/image-20220403175416189.png)

```
bash D:/ftp/upload.sh
```

### 服务端代码

```java
@PostMapping(value = "/upload")
public String upload( MultipartFile file){
    FileUtil fileUtil = new FileUtil();
    return fileUtil.uploadimge(file);
}
```